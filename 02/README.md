# λ°μ΄ν„° λ‹¤λ£¨κΈ°
[01] ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ
---
### 01. μ§€λ„ ν•™μµκ³Ό λΉ„μ§€λ„ ν•™μµ
#### μ§€λ„ ν•™μµ(supervised learning)
- μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦ : ν›λ ¨ν•κΈ° μ„ν• λ°μ΄ν„°μ™€ μ •λ‹µ ν•„μ”

  - ex. k-μµκ·Όμ ‘ μ΄μ›ƒ μ•κ³ λ¦¬μ¦

  - **ν›λ ¨ λ°μ΄ν„°**(training data) = **μ…λ ¥**(input, λ°μ΄ν„°) + **νƒ€κΉƒ**(target, μ •λ‹µ)
 
- μ •λ‹µ(νƒ€κΉƒ)μ΄ μμΌλ‹ μ•κ³ λ¦¬μ¦μ΄ μ •λ‹µμ„ λ§νλ” κ²ƒμ„ ν•™μµ

  - ex. λ„λ―ΈμΈμ§€ λΉ™μ–΄μΈμ§€ κµ¬λ¶„

<br>

#### λΉ„μ§€λ„ ν•™μµ(unsupervised learning)
- λΉ„μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦ : νƒ€κΉƒ μ—†μ΄ μ…λ ¥ λ°μ΄ν„°λ§ μ‚¬μ©

- μ •λ‹µμ„ μ‚¬μ©ν•μ§€ μ•μΌλ―€λ΅ λ¬΄μ–Έκ°€λ¥Ό λ§ν μ μ—†μ

- λ°μ΄ν„° νμ•… λλ” λ³€ν•μ— λ„μ›€

<br>

#### κ°•ν™” ν•™μµ(reinforcement learning)
- κ°•ν™” ν•™μµ μ•κ³ λ¦¬μ¦ : νƒ€κΉƒμ΄ μ•„λ‹λΌ μ•κ³ λ¦¬μ¦μ΄ ν–‰λ™ν• κ²°κ³Όλ΅ μ–»μ€ λ³΄μƒμ„ μ‚¬μ©ν•΄ ν•™μµλ¨

<br>

### 02. ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ
- λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¥΄μ§μ μ„±λ¥μ„ μ λ€λ΅ ν‰κ°€ν•λ ¤λ©΄ ν›λ ¨ λ°μ΄ν„°μ™€ ν‰κ°€μ— μ‚¬μ©ν•  λ°μ΄ν„°κ°€ κ°κ° λ‹¬λΌμ•Ό ν•¨

  - ν‰κ°€λ¥Ό μ„ν•΄ λ λ‹¤λ¥Έ λ°μ΄ν„°λ¥Ό μ¤€λΉ„
 
  - μ΄λ―Έ μ¤€λΉ„λ λ°μ΄ν„° μ¤‘μ—μ„ μΌλ¶€λ¥Ό λ–Όμ–΄ λ‚΄μ–΄ ν™μ© (μΌλ°μ μΌλ΅ λ§μ΄ μ‚¬μ©)
 
<BR>

#### ν…μ¤νΈ μ„ΈνΈ(test set)
- ν‰κ°€μ— μ‚¬μ©ν•λ” λ°μ΄ν„°

<br>

#### ν›λ ¨ μ„ΈνΈ(train set)
- ν›λ ¨μ— μ‚¬μ©λλ” λ°μ΄ν„°

<br>

> λ„λ―Έμ™€ λΉ™μ–΄μ λ°μ΄ν„°λ¥Ό ν•©μ³ ν•λ‚μ νμ΄μ¬ λ¦¬μ¤νΈλ΅ μ¤€λΉ„
```python
  fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 
                  31.0, 31.0, 31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5,
                  34.0, 34.0, 34.5, 35.0, 35.0, 35.0, 35.0, 36.0, 36.0, 37.0,
                  38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 10.5, 10.6, 11.0, 11.2, 
                  11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
  fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0,
                  450.0, 500.0, 475.0, 500.0, 500.0, 340.0, 600.0, 600.0,
                  700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0,
                  700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0,
                  925.0, 975.0, 950.0, 6.7, 7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 
                  9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```

> λ‘ νμ΄μ¬ λ¦¬μ¤νΈλ¥Ό μνν•λ©΄μ„ κ° μƒμ„ μ κΈΈμ΄μ™€ λ¬΄κ²λ¥Ό ν•λ‚μ λ¦¬μ¤νΈλ΅ λ‹΄μ€ 2μ°¨μ› λ¦¬μ¤νΈ μƒμ„±
```python
  fish_data = [[l, w] for l, w in zip(fish_length, fish_weight)]
  fish_target = [1] * 35 + [0] * 14
```
- ν•λ‚μ μƒμ„  λ°μ΄ν„°λ¥Ό **μƒν”**μ΄λΌ λ¶€λ¦„

  - λ„λ―Έμ™€ λΉ™μ–΄λ” κ°κ° 35λ§λ¦¬, 14λ§λ¦¬κ°€ μμΌλ―€λ΅ μ „μ²΄ λ°μ΄ν„°λ” 49κ°μ μƒν”λ΅ μ΄λ£¨μ–΄μ Έ μμ
 
- μ‚¬μ©ν•λ” νΉμ„±μ€ 2κ° (κΈΈμ΄, λ¬΄κ²)

<br>

<details>
  <summary>π’΅ μΈλ±μ¤ μ§€μ • λ° μ¬λΌμ΄μ‹±</summary>

<br>

> μ½”λ“
```python
  # μΈλ±μ¤ μ§€μ •
  print(fish_data[4], '\n')
  
  # μ¬λΌμ΄μ‹±
  print(fish_data[0:5])
  print(fish_data[:5])
  print(fish_data[44:49])
  print(fish_data[44:])
```
- λ¦¬μ¤νΈμ²λΌ λ°°μ—΄μ μ”μ†λ¥Ό μ„ νƒν•  λ•λ” λ°°μ—΄μ μ„μΉ(**μΈλ±μ¤**, index) μ§€μ •

  - λ°°μ—΄μ μΈλ±μ¤λ” 0λ¶€ν„° μ‹μ‘ β†’ λ‹¤μ„― λ²μ§Έ μƒν”μ μΈλ±μ¤ = 4
 
- **μ¬λΌμ΄μ‹±**(slicing) : μ½λ΅ (:)μ„ κ°€μ΄λ° λ‘κ³  μΈλ±μ¤μ λ²”μ„λ¥Ό μ§€μ •ν•μ—¬ μ—¬λ¬ κ°μ μ›μ† μ„ νƒ κ°€λ¥

  - **λ§μ§€λ§‰ μΈλ±μ¤μ μ›μ†λ” ν¬ν•¨λμ§€ μ•λ”λ‹¤**λ” μ  μ£Όμ
 
    - ex. '0:5' β‡’ 0~4 κΉμ§€μ 5κ° μ›μ†λ§ μ„ νƒλκ³  μΈλ±μ¤ 5μΈ μ—¬μ„― λ²μ§Έ μ›μ†λ” μ„ νƒ X
   
      - μ²μλ¶€ν„° μ‹μ‘λλ” μ¬λΌμ΄μ‹±μ κ²½μ° 0 μƒλµ κ°€λ¥
     
    - ex. '44:49' β‡’ '44:' λ΅ μ‚¬μ© κ°€λ¥
     
      - λ§μ§€λ§‰ μ›μ†κΉμ§€ ν¬ν•¨ν•  κ²½μ° λ‘ λ²μ¬ μΈλ±μ¤ μƒλµ κ°€λ¥

<br>

> κ²°κ³Ό
```python
  [29.0, 430.0] 
  
  [[25.4, 242.0], [26.3, 290.0], [26.5, 340.0], [29.0, 363.0], [29.0, 430.0]]
  [[25.4, 242.0], [26.3, 290.0], [26.5, 340.0], [29.0, 363.0], [29.0, 430.0]]
  [[12.2, 12.2], [12.4, 13.4], [13.0, 12.2], [14.3, 19.7], [15.0, 19.9]]
  [[12.2, 12.2], [12.4, 13.4], [13.0, 12.2], [14.3, 19.7], [15.0, 19.9]]
```

</details>

<br>

> μ²μ 35κ°λ¥Ό ν›λ ¨ μ„ΈνΈλ΅, λ‚λ¨Έμ§€ 14κ°λ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ μ‚¬μ©
```python
  from sklearn.neighbors import KNeighborsClassifier
  kn = KNeighborsClassifier()
  
  # ν›λ ¨ μ„ΈνΈλ΅ μ…λ ¥κ°’ μ¤‘ 0λ¶€ν„° 34λ²μ§Έ μΈλ±μ¤κΉμ§€ μ‚¬μ©
  train_input = fish_data[:35]
  # ν›λ ¨ μ„ΈνΈλ΅ νƒ€κΉƒκ°’ μ¤‘ 0λ¶€ν„° 34λ²μ§Έ μΈλ±μ¤κΉμ§€ μ‚¬μ©
  train_target = fish_target[:35]
  # ν…μ¤νΈ μ„ΈνΈλ΅ μ…λ ¥κ°’ μ¤‘ 35λ²μ§Έλ¶€ν„° λ§μ§€λ§‰ μΈλ±μ¤κΉμ§€ μ‚¬μ©
  test_input = fish_data[35:]
  # ν…μ¤νΈ μ„ΈνΈλ΅ νƒ€κΉƒκ°’ μ¤‘ 35λ²μ§Έλ¶€ν„° λ§μ§€λ§‰ μΈλ±μ¤κΉμ§€ μ‚¬μ©
  test_target = fish_target[35:]
  
  kn.fit(train_input, train_target)
  kn.score(test_input, test_target)
```
-  μ¬λΌμ΄μ‹± μ—°μ‚°μΌλ΅ μΈλ±μ¤ 0\~34 κΉμ§€ μ²μ 35κ° μƒν”μ„ ν›λ ¨ μ„ΈνΈλ΅ μ„ νƒ, μΈλ±μ¤ 35\~48 κΉμ§€ λ‚λ¨Έμ§€ 14κ° μƒν”μ„ ν…μ¤νΈ μ„ΈνΈλ΅ μ„ νƒ

-  λ°μ΄ν„° μ¤€λΉ„ ν›„ ν›λ ¨ μ„ΈνΈλ΅ fit() λ©”μ„λ“λ¥Ό νΈμ¶ν•΄ λ¨λΈ ν›λ ¨ ν›„ ν…μ¤νΈ μ„ΈνΈλ΅, score() λ©”μ„νΈλ¥Ό νΈμ¶ν•΄ ν‰κ°€

> κ²°κ³Ό
```python
  0.0
```
- μµμ•…μ μ„±λ¥ why?

  - fish_data μ— μμ„λ€λ΅ 35κ°μ λ„λ―Έμ™€ 14κ°μ λΉ™μ–΄ μƒν”μ΄ λ“¤μ–΄μμ
 
    - λ§μ§€λ§‰ 14κ°λ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ λ§λ“¤λ©΄ λΉ™μ–΄ λ°μ΄ν„°λ§ λ“¤μ–΄κ°
   
    - ν›λ ¨ μ„ΈνΈμ—λ” λ„λ―Έλ§ μκΈ° λ•λ¬Έμ— ν…μ¤νΈ μ„ΈνΈκ°€ λ¬΄μ—‡μ΄λ“  λ¬΄μ΅°κ±΄ λ„λ―ΈλΌκ³  λ¶„λ¥ν•λ―€λ΅ μ •λ‹µ λ§νμ§€ λ»ν•¨
   
- ν›λ ¨ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„°μ—λ” λ„λ―Έμ™€ λΉ™μ–΄κ°€ κ³¨κ³ λ£¨ μ„μ—¬ μμ–΄μ•Ό ν•¨

<br>

### 03. μƒν”λ§ νΈν–¥(sampling bias)
- ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ— μƒν”μ΄ κ³¨κ³ λ£¨ μ„μ—¬ μμ§€ μ•μΌλ©΄ μƒν”λ§μ΄ ν•μ½μΌλ΅ μΉμ°μΉ μƒνƒ

- νΉμ • μΆ…λ¥μ μƒν”μ΄ κ³Όλ„ν•κ² λ§μ€ μƒν”λ§ νΈν–¥μ„ κ°€μ§€κ³  μλ‹¤λ©΄ μ λ€λ΅ λ μ§€λ„ ν•™μµ λ¨λΈμ„ λ§λ“¤ μ μ—†μ

<br>

### 04. λ„νμ΄(numpy)
- νμ΄μ¬μ λ€ν‘μ μΈ λ°°μ—΄(array) λΌμ΄λΈλ¬λ¦¬

- κ³ μ°¨μ›μ λ°°μ—΄μ„ μ†μ‰½κ² λ§λ“¤κ³  μ΅°μ‘ν•  μ μλ” κ°„νΈν• λ„κµ¬ λ§μ΄ μ κ³µ

  - νμ΄μ¬μ λ¦¬μ¤νΈλ΅ 2μ°¨μ› λ¦¬μ¤νΈλ” ν‘ν„ κ°€λ¥ν•μ§€λ§ κ³ μ°¨μ› λ¦¬μ¤νΈ ν‘ν„μ€ λ²κ±°λ΅μ›€

  - μ°¨μ›(dimension)μ΄λ€ λ§μ€ μ΅°κΈμ”© λ‹¤λ¥Έ μλ―Έλ΅ μ“°μΌ μ μμΌλ‚ λ°°μ—΄μ—μ„ μ°¨μ›μ€ μΆν‘κ³„μ μ¶•κ³Ό κ°™μ

|1μ°¨μ› λ°°μ—΄|2μ°¨μ› λ°°μ—΄|3μ°¨μ› λ°°μ—΄|
|:-:|:-:|:-:|
|![μ΄λ―Έμ§€](./img/01.png)|![μ΄λ―Έμ§€](./img/02.png)|![μ΄λ―Έμ§€](./img/03.png)|
|μ„ |λ©΄|κ³µκ°„|

- λ°°μ—΄μ μ‹μ‘μ μ΄ μ™Όμ½ μ„μ—μ„λ¶€ν„° μ‹μ‘ν•¨

<br>

> μƒμ„  λ°μ΄ν„°λ¥Ό 2μ°¨μ› λ„νμ΄ λ°°μ—΄λ΅ λ³€ν™
```python
  import numpy as np
  
  input_arr = np.array(fish_data)
  target_arr = np.array(fish_target)
  
  print(input_arr)
  print(input_arr.shape)  # (μƒν” μ, νΉμ„± μ) μ¶λ ¥
```
- νμ΄μ¬ λ¦¬μ¤νΈλ¥Ό λ„νμ΄ λ°°μ—΄λ΅ λ°”κΎΈλ” λ°©λ²•

  - λ„νμ΄ array() ν•¨μμ— νμ΄μ¬ λ¦¬μ¤νΈλ¥Ό μ „λ‹¬
 
- shape μ†μ„± : λ°°μ—΄μ ν¬κΈ° ν™•μΈ

> κ²°κ³Ό
```python
  [[  25.4  242. ]
   [  26.3  290. ]
    ...
   [  15.    19.9]]
  (49, 2)
```
- λ„νμ΄λ” λ°°μ—΄μ μ°¨μ›μ„ κµ¬λ¶„ν•κΈ° μ‰½λ„λ΅ ν–‰κ³Ό μ—΄μ„ κ°€μ§€λ°ν μ¶λ ¥

  - 49κ°μ ν–‰κ³Ό 2κ°μ μ—΄ ν™•μΈ κ°€λ¥
 
<br>

> λλ¤μΌλ΅ μƒν” μ„ νƒ
```python
  np.random.seed(42)
  index = np.arange(49)
  np.random.shuffle(index)
  
  print(index)
```
- λ°°μ—΄μ„ μ„μ€ ν›„μ— λ‚λ„λ” λ°©μ‹ λ€μ‹  λ¬΄μ‘μ„λ΅ μƒν”μ„ κ³ λ¥΄λ” λ°©λ²• μ‚¬μ©

  - input_arr μ™€ target_arr μ—μ„ κ°™μ€ μ„μΉλ” ν•¨κ» μ„ νƒλμ–΄μ•Ό ν•¨
 
- μΈλ±μ¤λ¥Ό μ„μ€ λ‹¤μ input_arr μ™€ target_arr μ—μ„ μƒν”μ„ μ„ νƒν•λ©΄ λ¬΄μ‘μ„λ΅ ν›λ ¨ μ„ΈνΈλ¥Ό λ‚λ„λ” μ…

- λ„νμ΄ arange() ν•¨μ μ‚¬μ©ν•λ©΄ 0μ—μ„λ¶€ν„° 48κΉμ§€ 1μ”© μ¦κ°€ν•λ” μΈλ±μ¤ μƒμ„± κ°€λ¥

  - μ •μ N μ„ μ „λ‹¬ν•λ©΄ 0μ—μ„λ¶€ν„° N-1 κΉμ§€ 1μ”© μ¦κ°€ν•λ” λ°°μ—΄μ„ λ§λ“¦
 
    - λ„νμ΄ random ν¨ν‚¤μ§€ μ•„λμ— μλ” shuffle() ν•¨μλ” μ£Όμ–΄μ§„ λ°°μ—΄μ„ λ¬΄μ‘μ„λ΅ μ„μ

> κ²°κ³Ό
```python
  [13 45 47 44 17 27 26 25 31 19 12  4 34  8  3  6 40 41 46 15  9 16 24 33
   30  0 43 32  5 29 11 36  1 21  2 37 35 23 39 10 22 18 48 20  7 42 14 28
   38]
```

<br>

> λ°°μ—΄ μΈλ±μ‹±
```python
  print(input_arr[[1, 3]])
```
- input_arr μ—μ„ λ‘ λ²μ§Έμ™€ λ„¤ λ²μ§Έ μƒν”μ„ μ„ νƒν•μ—¬ μ¶λ ¥

> κ²°κ³Ό
```python
  [[ 26.3 290. ]
   [ 29.  363. ]]
```
- λ„νμ΄λ” μ¬λΌμ΄μ‹± μ™Έμ— **λ°°μ—΄ μΈλ±μ‹±**(array indexing) κΈ°λ¥ μ κ³µ

  - λ°°μ—΄ μΈλ±μ‹±μ€ 1κ°μ μΈλ±μ¤κ°€ μ•„λ‹ μ—¬λ¬ κ°μ μΈλ±μ¤λ΅ ν• λ²μ— μ—¬λ¬ κ°μ μ›μ† μ„ νƒ κ°€λ¥

<br>

> λ¦¬μ¤νΈ λ€μ‹  λ„νμ΄ λ°°μ—΄μ„ μΈλ°μ¤λ΅ μ „λ‹¬
```python
  train_input = input_arr[index[:35]]
  train_target = target_arr[index[:35]]
  
  print(input_arr[13], train_input[0])
```
- index λ°°μ—΄μ μ²μ 35κ°λ¥Ό input_arr μ™€ target_arr μ— μ „λ‹¬ν•μ—¬ λλ¤ν•κ² 35κ°μ μƒν”μ„ ν›λ ¨ μ„ΈνΈλ΅ λ§λ“¤κΈ°

> κ²°κ³Ό
```python
  [ 32. 340.] [ 32. 340.]
```
- λ§λ“¤μ–΄μ§„ index μ μ²« λ²μ§Έ κ°’μ€ 13

  - train_input μ μ²« λ²μ§Έ μ›μ†λ” input_arr μ μ—΄λ„¤ λ²μ§Έ μ›μ†κ°€ λ“¤μ–΄μμ„ κ²ƒ

<br>

> λ‚λ¨Έμ§€ 14κ°λ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ λ§λ“¤κΈ°
```python
  test_input = input_arr[index[35:]]
  test_target = target_arr[index[35:]]
```

<br>

> ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ— λ„λ―Έμ™€ λ°©μ–΄κ°€ μ μ„μ—¬ μλ”μ§€ μ‚°μ λ„λ΅ ν™•μΈ
```python
  import matplotlib.pyplot as plt
  plt.scatter(train_input[:, 0], train_input[:, 1])
  plt.scatter(test_input[:, 0], test_input[:, 1])
  plt.xlabel('length')
  plt.ylabel('weight')
  plt.show()
```
- 2μ°¨μ› λ°°μ—΄μ€ ν–‰κ³Ό μ—΄ μΈλ±μ¤λ¥Ό μ½¤λ§(,)λ΅ λ‚λ„μ–΄ μ§€μ •

  - μ¬λΌμ΄μ‹± μ—°μ‚°μλ΅ μ²μλ¶€ν„° λ§μ§€λ§‰ μ›μ†κΉμ§€ λ¨λ‘ μ„ νƒν•λ” κ²½μ° μ‹μ‘κ³Ό μΆ…λ£ μΈλ±μ¤λ¥Ό λ¨λ‘ μƒλµ κ°€λ¥
 
> κ²°κ³Ό

![image](https://github.com/user-attachments/assets/6c2f6fc6-849c-4466-9296-291fe6cf6895)

- νλ€μƒ‰ : ν›λ ¨ μ„ΈνΈ, μ£Όν™©μƒ‰ : ν…μ¤νΈ μ„ΈνΈ

  - μ–‘μ½μ— λ„λ―Έμ™€ λΉ™μ–΄κ°€ λ¨λ‘ μ„μ—¬ μμ

<br>

#### π’΅ λ„νμ΄μ—μ„ λ¬΄μ‘μ„ κ²°κ³Όλ¥Ό λ§λ“λ” ν•¨μλ“¤μ€ μ‹¤ν–‰ν•  λ•λ§λ‹¤ λ‹¤λ¥Έ κ²°κ³Όλ¥Ό λ§λ“¦
- μΌμ •ν• κ²°κ³Όλ¥Ό μ–»μΌλ ¤λ©΄ μ΄κΈ°μ— λλ¤μ‹λ“(random seed) μ§€μ •

<br>

### 05. λ‘ λ²μ§Έ λ¨Έμ‹ λ¬λ‹ ν”„λ΅κ·Έλ¨
- μ•μ„ λ§λ“  ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ΅ k-μµκ·Όμ ‘ μ΄μ›ƒ λ¨λΈ ν›λ ¨

- fit() λ©”μ„λ“ μ‹¤ν–‰ν•  λ•λ§λ‹¤ KNeighborsClassifier ν΄λμ¤μ κ°μ²΄λ” μ΄μ „μ— ν•™μµν• λ¨λ“  κ²ƒμ„ μƒμ–΄λ²„λ¦Ό

  - μ΄μ „ λ¨λΈμ„ κ·Έλ€λ΅ λ‘κ³  μ‹¶λ‹¤λ©΄ KNeighborsClassifier ν΄λμ¤ κ°μ²΄ μƒλ΅ μƒμ„±

> ν›λ ¨
```python
  kn.fit(train_input, train_target)
  
  # μΈλ±μ¤λ¥Ό μ„μ–΄ λ§λ“  train_input κ³Ό train_target μΌλ΅ λ¨λΈ ν›λ ¨
  kn.score(test_input, test_target)
```

> κ²°κ³Ό
```python
  1.0
```
- 100% μ •ν™•λ„λ΅ ν…μ¤νΈ μ„ΈνΈμ— μλ” λ¨λ“  μƒμ„± λ§ν

<br>

> μμΈ΅
```python
  print(kn.predict(test_input))
  print(test_target)
```
- predict() λ©”μ„λ“λ΅ ν…μ¤νΈ μ„ΈνΈμ μμΈ΅ κ²°κ³Όμ™€ μ‹¤μ  νƒ€κΉƒ ν™•μΈ

> κ²°κ³Ό
```python
  [0 0 1 0 1 1 1 0 1 1 0 1 1 0]
  [0 0 1 0 1 1 1 0 1 1 0 1 1 0]
```
- predict() λ©”μ„λ“κ°€ λ°ν™ν•λ” κ°’μ€ λ‹¨μν• νμ΄μ¬ λ¦¬μ¤νΈκ°€ μ•„λ‹λΌ λ„νμ΄ λ°°μ—΄

  - print μ—†μ΄ μ¶λ ¥μ‹ array() λ΅ κ°μ‹Έμ—¬ μμ
 
  - μ‚¬μ΄ν‚·λ° λ¨λΈμ μ…λ ¥κ³Ό μ¶λ ¥μ€ λ¨λ‘ λ„νμ΄ λ°°μ—΄
 
    - λ„νμ΄λ” λ§μ€ νμ΄μ¬ κ³Όν•™ λΌμ΄λΈλ¬λ¦¬μ—μ„ μ‚¬μ©ν•λ” ν‘μ¤€ λ°μ΄ν„°

<br>

> μ „μ²΄ μ½”λ“
```python
fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 
                31.0, 31.0, 31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5,
                34.0, 34.0, 34.5, 35.0, 35.0, 35.0, 35.0, 36.0, 36.0, 37.0,
                38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 10.5, 10.6, 11.0, 11.2, 
                11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0,
                450.0, 500.0, 475.0, 500.0, 500.0, 340.0, 600.0, 600.0,
                700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0,
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0,
                925.0, 975.0, 950.0, 6.7, 7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 
                9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]

fish_data = [[l, w] for l, w in zip(fish_length, fish_weight)]
fish_target = [1] * 35 + [0] * 14

from sklearn.neighbors import KNeighborsClassifier
kn = KNeighborsClassifier()

# ν›λ ¨ μ„ΈνΈλ΅ μ…λ ¥κ°’ μ¤‘ 0λ¶€ν„° 34λ²μ§Έ μΈλ±μ¤κΉμ§€ μ‚¬μ©
train_input = fish_data[:35]
# ν›λ ¨ μ„ΈνΈλ΅ νƒ€κΉƒκ°’ μ¤‘ 0λ¶€ν„° 34λ²μ§Έ μΈλ±μ¤κΉμ§€ μ‚¬μ©
train_target = fish_target[:35]
# ν…μ¤νΈ μ„ΈνΈλ΅ μ…λ ¥κ°’ μ¤‘ 35λ²μ§Έλ¶€ν„° λ§μ§€λ§‰ μΈλ±μ¤κΉμ§€ μ‚¬μ©
test_input = fish_data[35:]
# ν…μ¤νΈ μ„ΈνΈλ΅ νƒ€κΉƒκ°’ μ¤‘ 35λ²μ§Έλ¶€ν„° λ§μ§€λ§‰ μΈλ±μ¤κΉμ§€ μ‚¬μ©
test_target = fish_target[35:]

kn.fit(train_input, train_target)
kn.score(test_input, test_target)

# λ„νμ΄
import numpy as np

input_arr = np.array(fish_data)
target_arr = np.array(fish_target)

print(input_arr)
print(input_arr.shape)  # (μƒν” μ, νΉμ„± μ) μ¶λ ¥

np.random.seed(42)
index = np.arange(49)
np.random.shuffle(index)

print(index)

print(input_arr[[1, 3]])

train_input = input_arr[index[:35]]
train_target = target_arr[index[:35]]

print(input_arr[13], train_input[0])

test_input = input_arr[index[35:]]
test_target = target_arr[index[35:]]

import matplotlib.pyplot as plt
plt.scatter(train_input[:, 0], train_input[:, 1])
plt.scatter(test_input[:, 0], test_input[:, 1])
plt.xlabel('length')
plt.ylabel('weight')
plt.show()

# λ¨Έμ‹ λ¬λ‹ ν”„λ΅κ·Έλ¨
kn.fit(train_input, train_target)

kn.score(test_input, test_target)

print(kn.predict(test_input))
print(test_target)
```

<br>  

---

<br>

π¨ ν•µμ‹¬ μ •λ¦¬
---
- **μ§€λ„ ν•™μµ** : μ…λ ¥κ³Ό νƒ€κΉƒμ„ μ „λ‹¬ν•μ—¬ λ¨λΈμ„ ν›λ ¨ν• λ‹¤μ μƒλ΅μ΄ λ°μ΄ν„°λ¥Ό μμΈ΅ν•λ” λ° ν™μ©

  - k-μµκ·Όμ ‘ μ΄μ›ƒμ΄ μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦
 
- **λΉ„μ§€λ„ ν•™μµ** : νƒ€κΉƒ λ°μ΄ν„° μ—†μ

  - λ¬΄μ—‡μ„ μμΈ΅ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ…λ ¥ λ°μ΄ν„°μ—μ„ μ–΄λ–¤ νΉμ§•μ„ μ°Ύλ” λ° μ£Όλ΅ ν™μ©
 
- **ν›λ ¨ μ„ΈνΈ** : λ¨λΈμ„ ν›λ ¨ν•  λ• μ‚¬μ©ν•λ” λ°μ΄ν„°

  - λ³΄ν†µ ν›λ ¨ μ„ΈνΈκ°€ ν΄μλ΅ μΆ‹μ
 
  - ν…μ¤νΈ μ„ΈνΈλ¥Ό μ μ™Έν• λ¨λ“  λ°μ΄ν„°λ¥Ό μ‚¬μ©
 
- **ν…μ¤νΈ μ„ΈνΈ** : μ „μ²΄ λ°μ΄ν„°μ—μ„ 20~30%λ¥Ό ν…μ¤νΈ μ„ΈνΈλ΅ μ‚¬μ©ν•λ” κ²½μ°κ°€ λ§μ

  - μ „μ²΄ λ°μ΄ν„°κ°€ μ•„μ£Ό ν¬λ‹¤λ©΄ 1%λ§ λμ–΄λ‚΄λ„ μ¶©λ¶„ν•  μ μμ
 
- **numpy**

  - **seed()** : λ„νμ΄μ—μ„ λ‚μλ¥Ό μƒμ„±ν•κΈ° μ„ν• μ •μ μ΄κΈ°κ°’ μ§€μ •
 
    - μ΄κΈ°κ°’μ΄ κ°™μΌλ©΄ λ™μΌν• λ‚μ λ½‘μ„ μ μμ
   
    - λλ¤ ν•¨μμ κ²°κ³Όλ¥Ό λ™μΌν•κ² μ¬ν„ν•κ³  μ‹¶μ„ λ• μ‚¬μ©
   
  - **arange()** : μΌμ •ν• κ°„κ²©μ μ •μ λλ” μ‹¤μ λ°°μ—΄ μƒμ„±
 
    - κΈ°λ³Έ κ°„κ²©μ€ 1
   
    - λ§¤κ°λ³€μκ°€ ν•λ‚μ΄λ©΄ μΆ…λ£ μ«μ μλ―Έ
   
    - 0μ—μ„ μΆ…λ£ μ«μκΉμ§€ λ°°μ—΄ μƒμ„±
   
    - μΆ…λ£ μ«μλ” λ°°μ—΄μ— ν¬ν•¨λμ§€ μ•μ
   
    - λ§¤κ°λ³€μκ°€ 2κ°λ©΄ μ‹μ‘ μ«μ, μΆ…λ£ μ«μ μλ―Έ
   
    - λ§¤κ°λ³€μκ°€ 3κ°λ©΄ λ§μ§€λ§‰ λ§¤κ°λ³€μκ°€ κ°„κ²©μ„ λ‚νƒ€λƒ„
   
  - **shuffle()** : μ£Όμ–΄μ§„ λ°°μ—΄μ„ λλ¤ν•κ² μ„μ
 
    - λ‹¤μ°¨μ› λ°°μ—΄μΌ κ²½μ° μ²« λ²μ§Έ μ¶•(ν–‰)μ— λ€ν•΄μ„λ§ μ„μ

> ex
```python
  print(np.arange(3))
  print(np.arange(1, 3))
  print(np.arange(1, 3, 0.2))
  
  arr = np.array([[1, 2], [3, 4], [5, 6]])
  np.random.shuffle(arr)
  print(arr)
```

> κ²°κ³Ό
```python
  [0 1 2]
  [1 2]
  [1.  1.2 1.4 1.6 1.8 2.  2.2 2.4 2.6 2.8]
  
  [[5 6]
   [1 2]
   [3 4]]
```

<br>  

---

<br>

[2] λ°μ΄ν„° μ „μ²λ¦¬
---
### 01. λ„νμ΄λ΅ λ°μ΄ν„° μ¤€λΉ„
> μƒμ„  λ°μ΄ν„°
```python
  fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 
                  31.0, 31.0, 31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5,
                  34.0, 34.0, 34.5, 35.0, 35.0, 35.0, 35.0, 36.0, 36.0, 37.0,
                  38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 10.5, 10.6, 11.0, 11.2, 
                  11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
  fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0,
                  450.0, 500.0, 475.0, 500.0, 500.0, 340.0, 600.0, 600.0,
                  700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0,
                  700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0,
                  925.0, 975.0, 950.0, 6.7, 7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 
                  9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```
- μ΄μ „μ—λ” νμ΄μ„  λ¦¬μ¤νΈλ¥Ό μνν•λ©΄μ„ μ›μ†λ¥Ό ν•λ‚μ”© κΊΌλ‚΄ λ¦¬μ¤νΈ μ•μ λ¦¬μ¤νΈλ΅ μ§μ ‘ κµ¬μ„±

<br>

> λ„νμ΄ μƒμ„± μμ 
```python
  import numpy as np
  np.column_stack(([1,2,3],[4,5,6]))
```
- column_stack() ν•¨μ : μ „λ‹¬λ°›μ€ λ¦¬μ¤νΈλ¥Ό μΌλ ¬λ΅ μ„Έμ΄ λ‹¤μ μ°¨λ΅€λ€λ΅ λ‚λ€ν μ—°κ²°

> κ²°κ³Ό
```python
  array([[1, 4],
         [2, 5],
         [3, 6]])
```
- λ§λ“¤μ–΄μ§„ λ°°μ—΄μ€ (3, 2) ν¬κΈ°μ λ°°μ—΄ β‡’ 3κ°μ ν–‰, 2κ°μ μ—΄

<br>

> fish_length μ™€ fish_weight ν•©μΉκΈ°
```python
  fish_data = np.column_stack((fish_length, fish_weight))
  print(fish_data[:5])
```

> κ²°κ³Ό
```python
  [[ 25.4 242. ]
   [ 26.3 290. ]
   [ 26.5 340. ]
   [ 29.  363. ]
   [ 29.  430. ]]
```
- λ„νμ΄ λ°°μ—΄ μ¶λ ¥μ‹ λ¦¬μ¤νΈμ²λΌ ν• μ¤„λ΅ κΈΈκ² μ¶λ ¥λμ§€ μ•κ³  ν–‰κ³Ό μ—΄μ„ λ§μ¶° μ •λ¦¬λ λ¨μµμΌλ΅ λ³΄μ„

<br>

#### π’΅ νν”(tuple)
- νμ΄μ¬ νν”μ€ λ¦¬μ¤νΈμ™€ λ§¤μ° λΉ„μ·ν•¨

- λ¦¬μ¤νΈμ²λΌ μ›μ†μ— μμ„κ°€ μμ§€λ§ ν• λ² λ§λ“¤μ–΄μ§„ νν”μ€ μμ • λ¶κ°€

- νν”μ„ μ‚¬μ©ν•λ©΄ ν•¨μλ΅ μ „λ‹¬ν• κ°’μ΄ λ°”λ€μ§€ μ•λ”λ‹¤λ” κ²ƒμ„ λ―Ώμ„ μ μμ

  - λ§¤κ°λ³€μ κ°’μΌλ΅ λ§μ΄ μ‚¬μ©

<br>

> νƒ€κΉƒ λ°μ΄ν„° μƒμ„±
```python
  fish_target = np.concatenate((np.ones(35), np.zeros(14)))
  print(fish_target)
```
- np.ones(), np.zeros() : κ°κ° μ›ν•λ” κ°μμ 1κ³Ό 0μ„ μ±„μ΄ λ°°μ—΄ μƒμ„±ν•΄μ¤

- np.concatenate() : μ²« λ²μ§Έ μ°¨μ›μ„ λ”°λΌ λ°°μ—΄ μ—°κ²°

  - np.column_stack() κ³Ό λ§μ°¬κ°€μ§€λ΅ μ—°κ²°ν• λ¦¬μ¤νΈλ‚ λ°°μ—΄μ„ νν”λ΅ μ „λ‹¬ν•΄μ•Ό ν•¨

> κ²°κ³Ό
```python
  [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
   1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0.]
```

<br>

|np.column_stack() VS np.concatenate()|
|:-:|
|![μ΄λ―Έμ§€](./img/04.png)|

<br>

### 02. μ‚¬μ΄ν‚·λ°μΌλ΅ ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ λ‚λ„κΈ°
> μ‚¬μ΄ν‚·λ° ν™μ©
```python
  from sklearn.model_selection import train_test_split
  train_input, test_input, train_target, test_target = train_test_split(fish_data, fish_target, random_state=42)
  print(train_input.shape, test_input.shape)
  print(train_target.shape, test_target.shape)
```
- train_test_split() : μ „λ‹¬λλ” λ¦¬μ¤νΈλ‚ λ°°μ—΄μ„ λΉ„μ¨μ— λ§κ² ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ΅ λ‚λ„μ–΄ μ¤(λ‚λ„κΈ° μ „μ— μ•μ•„μ„ μ„μ–΄μ¤)

  - μ‚¬μ΄ν‚·λ°μ model_selection λ¨λ“ μ•„λ μμ
 
  - κΈ°λ³Έμ μΌλ΅ 35% ν…μ¤νΈ μ„ΈνΈλ΅ λ–Όμ–΄λƒ„

- fish_data μ™€ fish_target 2κ°μ λ°°μ—΄ μ „λ‹¬ β†’ 2κ°μ”© λ‚λ‰μ–΄ μ΄ 4κ°μ λ°°μ—΄ λ°ν™

  - μ°¨λ΅€λ€λ΅ μ²μ 2κ°λ” μ…λ ¥ λ°μ΄ν„°(train_input, test_input), λ‚λ¨Έμ§€ 2κ°λ” νƒ€κΉƒ λ°μ΄ν„°(train_target, test_target)
 
- λλ¤ μ‹λ“(randon_state)λ” 42λ΅ μ§€μ •

> κ²°κ³Ό
```python
  (36, 2) (13, 2)
  (36,) (13,)
```
- ν›λ ¨ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„°λ¥Ό κ°κ° 36κ°, 13κ°λ΅ λ‚λ”

  - μ…λ ¥ λ°μ΄ν„° : 2κ°μ μ—΄μ΄ μλ” 2μ°¨μ› λ°°μ—΄
 
  - νƒ€κΉƒ λ°μ΄ν„° : 1μ°¨μ› λ°°μ—΄
 
- λ„νμ΄ λ°°μ—΄μ ν¬κΈ°λ” νμ΄μ¬μ νν”λ΅ ν‘ν„

  - νν”μ μ›μ†κ°€ ν•λ‚λ©΄ μ›μ† λ’¤μ— μ½¤λ§ μ¶”κ°€
 
    - νƒ€κΉƒ λ°μ΄ν„°λ” 1μ°¨μ› λ°°μ—΄γ„Ήμ΄λ―€λ΅ μ›μ†κ°€ ν•λ‚μΈ νν”λ΅ ν‘ν„λ κ²ƒ

<br>

> ν…μ¤νΈ λ°μ΄ν„° μ¶λ ¥
```python
  print(test_target)
```

> κ²°κ³Ό
```python
  [1. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
```
- 13κ°μ ν…μ¤νΈ μ„ΈνΈ μ¤‘ 10κ°κ°€ λ„λ―Έ(1), 3κ°κ°€ λΉ™μ–΄(0) β‡’ λ‘ μƒμ„ μ λΉ„μ¨ 3.3:1

  - μΌλ¶€ ν΄λμ¤μ κ°μκ°€ μ μ„ λ• μƒν”λ§ νΈν–¥ λ°μƒ
 
<br>

> κ°μ„ 
```python
  train_input, test_input, train_target, test_target = train_test_split(fish_data, fish_target, stratify=fish_target, random_state=42)
  print(test_target)
```
- stratify λ§¤κ°λ³€μμ— νƒ€κΉƒ λ°μ΄ν„° μ „λ‹¬μ‹ ν΄λμ¤ λΉ„μ¨μ— λ§κ² λ°μ΄ν„° λ‚λ μ¤

> κ²°κ³Ό
```python
  [0. 0. 1. 0. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
```
- λ‘ μƒμ„ μ λΉ„μ¨ 2.25:1 λ΅ μ „μ²΄ ν›λ ¨ λ°μ΄ν„°μ λΉ„μ¨κ³Ό λΉ„μ·ν•΄μ§

<br>

